return {
    "ThePrimeagen/harpoon",
    branch = "harpoon2",
    dependencies = { "nvim-lua/plenary.nvim" },

    config = function()
        -- Ensure plenary is loaded
        local ok, plenary = pcall(require, "plenary")
        if not ok then
            vim.notify("Plenary.nvim not found!", vim.log.levels.ERROR)
            return
        end

        local harpoon = require("harpoon")
        harpoon.setup()

--        local mark = require("harpoon.mark")
--        local ui = require("harpoon.ui")
--
--        vim.keymap.set("n", "<leader>a", mark.add_file)  -- Add file to Harpoon
--        vim.keymap.set("n", "<C-m>", ui.toggle_quick_menu)  -- Toggle Harpoon menu
--
--        vim.keymap.set("n", "<C-h>", function() ui.nav_file(1) end)
--        vim.keymap.set("n", "<C-j>", function() ui.nav_file(2) end)
--        vim.keymap.set("n", "<C-k>", function() ui.nav_file(3) end)
--        vim.keymap.set("n", "<C-l>", function() ui.nav_file(4) end)
--
--        vim.keymap.set("n", "<C-S-P>", ui.nav_prev)
--        vim.keymap.set("n", "<C-S-N>", ui.nav_next)
--

        -- Key mappings
        vim.keymap.set("n", "<leader>a", function() harpoon.list:add() end, { desc = "Add file to Harpoon" })
        vim.keymap.set("n", "<C-e>", function() harpoon.ui:toggle_quick_menu(harpoon.list) end, { desc = "Toggle Harpoon Menu" })

        -- Selecting files in Harpoon
        vim.keymap.set("n", "<C-h>", function() harpoon.list:select(1) end)
        vim.keymap.set("n", "<C-t>", function() harpoon.list:select(2) end)
        vim.keymap.set("n", "<C-n>", function() harpoon.list:select(3) end)
        vim.keymap.set("n", "<C-s>", function() harpoon.list:select(4) end)

        -- Navigate through Harpoon list
        vim.keymap.set("n", "<C-S-P>", function() harpoon.list:prev() end)
        vim.keymap.set("n", "<C-S-N>", function() harpoon.list:next() end)

    end
}

